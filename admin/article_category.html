<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>文章列表</title>
    <link rel="stylesheet" href="./libs/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/iconfont.css">
    <link rel="stylesheet" href="css/main.css">
    <script src="./libs/jquery-1.12.4.min.js"></script>
    <script src="./libs/bootstrap/js/bootstrap.min.js"></script>
    <!-- 引入模板引擎js文件 -->
    <script src="./libs/template-web.js"></script>
</head>

<body>
    <div class="container-fluid">
        <div class="common_title">
            文章类别管理
        </div>
        <div class="container-fluid common_con">
            <table class="table table-striped table-bordered table-hover mp20 category_table">
                <thead>
                    <tr>
                        <th>名称</th>
                        <th>Slug</th>
                        <th class="text-center" width="100">操作</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>奇趣事</td>
                        <td>funny</td>
                        <td class="text-center">
                            <a href="javascript:void(0)" data-toggle="modal" class=" btn btn-info btn-xs">编辑</a>
                            <a href="javascript:void(0)" class="btn btn-danger btn-xs">删除</a>
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="3" class="text-center">
                            <a href="javascript:void(0)" class="btn btn-success" id="xinzengfenlei" data-toggle="modal"
                                data-target="#myModal">新增分类</a>
                        </td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>
    <!-- 引入核心封装的文件 -->
    <script src="./js/http.js"></script>
    <!-- // 1 头部已经导入模板引擎 -->
    <!-- // 2 自定义模板 -->
    <script id="list" type="text/html">
        {{ each data }}
        <tr>
            <td>{{ $value.name }}</td>
            <td>{{ $value.slug }}</td>
            <td class="text-center">
                <a data-id="{{ $value.id }}" href="javascript:void(0)" data-toggle="modal" class=" btn btn-info btn-xs">编辑</a>
                <a data-id="{{ $value.id }}" href="javascript:void(0)" class="btn btn-danger btn-xs">删除</a>
            </td>
        </tr>
        {{ /each }}
    </script>
    <script>
        $(function(){

            // 封装：获取到列表数据并渲染到页面中
            function getListRender(){
                // #### 5、所有文章类别
                // 请求地址：/admin/category/list
                // 请求方式：get
                $.ajax({
                    type: "get",
                    url: BigNew.category_list,
                    dataType: "json",
                    success: function (response) {
                        // 3 准备数据，ajax 请求成功那就是数据准备好了
                        console.log(response);
                        // 4 调用模板 - template('id名称', 数据)
                        const htmlStr = template('list', response)  
                        // 5 渲染页面
                        $('tbody').html(htmlStr);
                    }
                });
            }

            // 调用：页面加载的时候先获取一次数据并渲染
            getListRender();
            
        });
    </script>
</html>